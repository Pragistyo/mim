<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous"></script>
    <script src=""></script>
    
    <!--Latest compiled and minified CSS-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
        crossorigin="anonymous">
    
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue"></script>
    <title>Form Upload</title>
</head>
<body>
    <div class="container" id="app">
        <uploadfile></uploadfile>
    </div>
    <script>
        Vue.component('uploadfile', {
            template: `<div><div v-if="!image">
            <button 
            type="button" 
            class="btn btn-info btn-lg" 
            data-toggle="modal" 
            data-target="#myModal"
            @click="dismissModal"
            >Open Modal</button>
        </div>
        <div v-else>
            <button type="button" class="btn btn-warning bt-lg" @click="removeImage">Remove Image</button>
        </div>
        <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
        
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <legend>
                            Upload File
                        </legend>
                    </div>
                    <div class="modal-body">
                        <form 
                        v-on:submit.prevent="createImage" 
                        class="form-horizontal">
                            <fieldset>
                                <div class="form-group">
                                    <label for="inputEmail" class="col-lg-2 control-label">Picture</label>
                                    <div class="col-md-8">
                                        <input 
                                        type="file" 
                                        class="form-control" 
                                        id="upload" 
                                        placeholder="File Picture"
                                        @change="onFileChange">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-lg-10 col-lg-offset-2">
                                        <div class="modal-footer">
                                            <button 
                                            type="submit" 
                                            class="btn btn-primary"
                                            >Submit</button>
                                            <button type="reset" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <img :src="image" />asdasd
        </div></div>`,
        data: function () {
            return {
                image: '',
                resultUpload: null,
                closeModal: null
            }
        },
        methods: {
            onFileChange(e) {
                // alert(JSON.stringify(e))
                console.log(e)
                var files = e.target.files || e.dataTransfer.files;

                if (!files.length) {
                    return;
                }
                this.resultUpload = files[0]
                console.log(this.resultUpload)
                // this.createImage(files[0]);
            },
            createImage(file) {
                var image = new Image();
                var reader = new FileReader();
                var vm = this;

                reader.onload = (e) => {
                    vm.image = e.target.result;
                };
                // reader.readAsDataURL(file);
                reader.readAsDataURL(this.resultUpload);
                $('#myModal').modal('hide');
            },
            removeImage: function (e) {
                this.image = '';
            },
            dismissModal: function () {
                // this.closeModal = "modal"
            }
        }
        })
        new Vue({
                el: '#app',
                data: {
                    // image: '',
                    // resultUpload: null,
                    // closeModal: null
                },
                methods: {
                    // onFileChange(e) {
                    //     // alert(JSON.stringify(e))
                    //     console.log(e)
                    //     var files = e.target.files || e.dataTransfer.files;

                    //     if (!files.length){
                    //         return;
                    //     }
                    //     this.resultUpload = files[0]
                    //     console.log(this.resultUpload)
                    //     // this.createImage(files[0]);
                    // },
                    // createImage(file) {
                    //     var image = new Image();
                    //     var reader = new FileReader();
                    //     var vm = this;

                    //     reader.onload = (e) => {
                    //         vm.image = e.target.result;
                    //     };
                    //     // reader.readAsDataURL(file);
                    //     reader.readAsDataURL(this.resultUpload);
                    //     $('#myModal').modal('hide');
                    // },
                    // removeImage: function (e) {
                    //     this.image = '';
                    // },
                    // dismissModal: function () {
                    //     // this.closeModal = "modal"
                    // }
                }
            })
    </script>
</body>
</html>